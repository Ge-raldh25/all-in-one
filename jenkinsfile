pipeline {
    agent any 
      stages {
          stage('Clone') {
          steps {
            sh '''
            rm -rf all-in-one
            git clone --branch master https://github.com/Ge-raldh25/all-in-one.git
              '''
                }
                         }
                         
            //stage('Analyse (optionnel)') {
            //steps {
            //echo "Ici, tu peux ajouter SonarQube si tu veux analyser ton code HTML (ex: lint, check qualité, etc.)"
               //   }
                              //           }
                                         
            stage('Build') {
            steps {
               sh '''
               cd all-in-one
               ls -1
               echo "Build terminé : fichiers prêts pour Docker."
                   '''
                   }
                            }

              stage('Docker Build') {
              steps {
                 sh '''
                 cd all-in-one
                 docker build -t citation .
                 echo "Image Docker construite : citation"
                     '''
                    }
                                    }

            stage('Push to Registry (optionnel)') {
               steps {
                  sh '''
                  echo "Connexion au registry  Docker Hub"
                  docker login -u geraldh443 -p 0149Jss.@
                  docker tag citation geraldh443/citation:latest
                  docker push geraldh/citation:latest
                     '''
                     }
                                                  }

  }
}
